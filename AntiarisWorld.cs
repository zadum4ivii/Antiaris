using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Microsoft.Xna.Framework;
using Terraria;
using Terraria.GameContent.Generation;
using Terraria.ID;
using Terraria.Localization;
using Terraria.ModLoader;
using Terraria.ModLoader.IO;
using Terraria.World.Generation;

namespace Antiaris
{ 
    public class AntiarisWorld : ModWorld
    {
        public static bool savedAdventurer = false;
        public static bool DownedAntlionQueen = false;
        public static bool DownedTowerKeeper = false;
        public static bool DownedBarrier = false;
        public static int StartPositionX = 0;
        public static int StartPositionY = 0;
        public static ushort ChestType = (ushort)ModLoader.GetMod("Antiaris").TileType("Cabinet");
        public static int Bed = 0;
        public static int Table = 0;
        public static int Wood = TileID.WoodBlock;
        public static int WoodWall = 4;
        public static int StoneWall = 5;
        public static int Brick = 38;
        public static int WoodTile = 106;
        public static int Door = 0;
        public static int Platform = 0;
        public static int Stone = TileID.Stone;
        public static int LivingWoodWall = 78;
        public static int PlankedWall = 27;
        public static int StoneSlab = 273;
        public static int StoneSlabWall = 147;
        public static int Fence = 106;
        public static int Grass = 2;
        public static int Chair = 0;
        public static ushort Mailbox = (ushort)ModLoader.GetMod("Antiaris").TileType("Mailbox");
        public static ushort Dray = (ushort)ModLoader.GetMod("Antiaris").TileType("LeafDray");
        private static bool GenerateHouse = false;
        private static bool GenerateBoat = false;
        private static bool GenerateTorment = false;
        private static bool GenerateStone = false;
        private static bool GeneratePyramid = false;
        private static bool GenerateCrystal = false;
        private static bool GenerateSubmarine = false;
        private static bool GenerateFinder = false;
        private static bool GenerateMirrorTower = false;
        private static bool GenerateSnowHouse = false;
        public static bool frozenTime = false;

        //0=air, 1=snow, 2=boreal wood, 3=wooden beam, 4=glass, 5=boreal wood platform, 6=cobweb

        static readonly byte[,] SnowHouseTiles =
        {
			{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
			{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
			{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
			{1,1,1,1,1,1,7,5,5,5,3,7,3,7,3,7,3,7,3,7,3,7,3,7,3,7,3,1,1,1,1,1,1},
			{7,1,1,1,1,1,7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,7,7},
			{7,7,1,1,7,7,7,7,7,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,1,1,1,7,7,7},
			{7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,1,1,7,7,7,7},
			{7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,5,5,7,7,7,7,7,7,4,7,7,7,7,7,7},
			{7,7,7,7,7,7,7,7,7,7,7,2,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,7,7,7,7,7,7},
			{7,7,7,7,7,7,7,2,5,5,5,2,2,7,5,5,5,5,7,7,7,7,7,7,7,2,2,2,7,7,7,7,7},
			{0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0},
			{0,0,0,0,0,0,1,1,2,2,2,2,0,0,6,6,6,0,0,0,0,0,0,2,2,2,2,1,1,0,0,0,0},
			{0,0,0,0,0,0,1,1,1,1,2,2,2,2,0,6,0,0,0,0,0,2,2,2,2,1,1,1,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0}
		};

        //0=none, 1=bottom-left, 2=bottom-right, 3=top-left, 4=top-right, 5=half
        static readonly byte[,] SnowHouseSlopes =
        {
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{5,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5},
			{0,2,0,0,0,5,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0},
			{0,0,5,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,1,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,4,0,0,0,0,3,0,5,5,5,5,0,0,0,0,0,0,0,4,0,3,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,5,0,0,0,0,0,0,3,0,0,0,0,0,0,0,4,0,0,0,0,0,5,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,3,0,0,0,4,0,0,0,0,0,0,1,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0}
		};

        //0=none, 1=boreal wood wall, 2=wood wall, 3=living wood wall, 4=boreal wood fence, 5=glass wall
        static readonly byte[,] SnowHouseWalls = 
		{
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,0,0,1,3,1,1,1,1,1,1,1,1,1,1,3,1,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,0,0,1,3,1,5,0,1,1,1,1,1,1,1,3,1,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,0,0,1,3,1,0,5,1,1,1,1,1,1,1,3,1,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,0,0,1,3,1,1,1,1,1,1,1,1,1,1,3,1,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
		};


        //0=air, 1=dirt/snow/ice, 2=wood, 3=stone brick, 4=stone, 5=platform, 6=stone slab, 7=grass		
        static readonly byte[,] GuideHouse =
        {
			{1,1,4,4,4,1,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1},
			{1,1,4,4,1,1,3,6,6,6,6,6,6,6,3,4,4,4,1,1,4,4,1,1},
            {1,1,1,1,1,1,3,6,0,0,0,0,0,6,3,1,4,4,1,4,4,1,1,4},
            {1,1,1,1,1,4,3,6,0,0,0,0,0,6,3,1,1,1,4,4,1,1,4,4},
            {7,7,7,3,3,3,3,6,0,0,6,6,6,6,3,3,3,3,3,3,3,1,1,4},
            {0,0,0,2,2,2,2,1,0,0,2,2,2,2,2,2,1,1,1,2,2,7,7,7},
            {8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8},
            {8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8},
            {8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8},
            {8,8,8,8,8,8,8,5,5,5,5,8,8,8,8,8,8,8,8,2,8,8,8,8},
            {8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,2,8,8,8,8},
            {8,8,8,8,2,2,8,8,8,8,8,8,8,8,8,8,8,8,2,2,8,8,8,8},
            {0,0,0,0,2,2,2,5,5,5,5,2,2,2,2,2,2,2,2,2,3,3,0,0},
			{0,0,0,0,3,2,2,0,0,0,0,0,0,0,0,0,0,2,2,3,3,3,0,0},
			{0,0,0,0,3,3,2,2,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0},
			{0,0,0,0,0,3,3,2,2,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0},
			{0,0,0,0,0,3,3,3,2,2,0,0,0,0,2,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,3,3,3,2,2,0,0,2,2,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,3,3,3,2,2,2,2,3,3,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,3,3,3,2,2,3,3,3,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0}
		};

        //0=air, 1=stone wall, 2=wooden wall, 3=living wood wall, 4=planked wall, 5=stone slab wall, 6=fence
        static readonly byte[,] GuideHouseWall =
        {
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0},
			{6,6,6,6,6,0,0,2,5,5,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{6,0,6,6,6,2,3,2,2,2,2,0,0,0,0,0,2,3,2,6,6,6,6,6},
			{0,0,6,0,6,0,0,2,2,2,2,0,0,0,2,2,2,3,2,6,0,6,6,0},
			{0,0,6,0,0,0,0,0,2,2,2,2,0,0,2,2,2,3,2,0,0,0,6,0},
			{0,0,0,0,0,0,0,0,2,2,2,2,3,2,2,2,2,3,2,0,0,0,0,0},
			{0,0,0,0,0,0,3,2,2,2,2,2,3,2,2,2,2,3,2,0,0,0,0,0},
			{0,0,0,0,0,2,3,2,2,2,2,2,3,2,2,2,2,3,2,0,0,0,0,0},
			{0,0,0,0,0,0,4,3,4,4,3,4,4,3,4,4,3,4,0,0,0,0,0,0},
			{0,0,0,0,0,0,4,3,4,4,3,4,4,3,4,4,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,3,4,4,3,4,4,3,4,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,3,4,4,3,4,4,3,4,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,4,4,4,3,4,4,3,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,4,4,3,4,4,3,4,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,4,3,4,4,3,4,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
		};

        //0=none, 1=bottom-left, 2=bottom-right, 3=top-left, 4=top-right, 5=half
        static readonly byte[,] GuideHouseSlopes =
        {
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,2,0,0,0,3,0,0,0,0,0,0,0,0,0,0,4,0,0,0,1,0,0},
			{0,0,0,2,0,0,0,3,0,0,0,0,0,0,0,0,4,0,0,0,1,0,0,0},
			{0,0,0,0,2,0,0,0,3,0,0,0,0,0,0,4,0,0,0,1,0,0,0,0},
			{0,0,0,0,0,2,0,0,0,3,0,0,0,0,4,0,0,0,1,0,0,0,0,0},
			{0,0,0,0,0,0,2,0,0,0,3,0,0,4,0,0,0,1,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,2,0,0,0,3,4,0,0,0,1,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0}
		};

        //0=air, 1=spooky wood, 2=wooden bean
        private static readonly byte[,] BoatTiles =
        {
            {0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0},
            {0,0,1,1,0,0,0,2,0,0,0,2,0,0,1,1,1,0,0,0,0,0},
            {0,1,1,0,0,0,0,2,0,0,0,2,0,0,0,0,1,1,1,0,0,0},
            {1,1,1,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,1,1,0,0},
            {0,1,1,1,1,1,1,1,0,0,0,2,0,0,0,0,0,0,0,1,1,1},
            {0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,1,1,1,1,1,1,1,1,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,1,1,1,1,1,1,0,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=air, 1=spooky wall, 2=spooky fence, 3=sail
        private static readonly byte[,] BoatWalls =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0},
            {0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0},
            {0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0},
            {0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0},
            {0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,2,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0},
            {0,0,0,0,0,0,0,3,3,3,0,0,0,2,0,0,0,0,2,0,0,0},
            {0,0,0,0,0,0,0,3,3,3,0,0,0,2,0,0,0,0,2,0,0,0},
            {0,0,0,0,0,0,3,3,3,3,3,0,0,2,0,0,0,0,2,0,0,0},
            {0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=none, 1=bottom-left, 2=bottom-right, 3=top-left, 4=top-right, 5=half
        private static readonly byte[,] BoatSlopes =
        {
            {0,0,0,4,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0},
            {0,0,4,1,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,0,0,0},
            {0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,0},
            {4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,0,0},
            {0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3},
            {0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,5,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=none, 1=active(fals)
        private static readonly byte[,] BoatNoneActive =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=none, 1=oil rag sconse, 2=trapdoor, 3=alchemy lantern, 4=platform, 5=wooden crate, 6=bookcase, 7=keg, 8=bottle, 9=barrel
        private static readonly byte[,] BoatObjects =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,5,0,0,0,6,0,0,0,7,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,3,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0},
            {0,0,0,0,0,0,4,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,4,4,4,0,4,4,4,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=air, 1=none, 2=sandstone, 3=sand, 4=cloud, 5=ore
        private static readonly byte[,] PyramidTiles =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,4,4,4,4,4,4,4,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,4,4,4,4,4,4,0,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,3,3,3,3,3,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0},
            {1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1},
            {1,1,1,1,1,4,4,4,4,4,4,4,4,4,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1},
            {1,1,1,1,1,4,4,4,4,4,4,4,4,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1},
            {1,1,1,1,4,4,4,4,4,4,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1},
            {1,1,1,4,4,4,4,4,4,3,3,3,3,3,3,3,3,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,1,1},
            {1,1,1,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,4,4,4,4,4,4,4,4,4,1},
            {1,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,3,3,3,3,3,3,3,4,4,4,4,4,4,1},
            {1,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,3,3,3,3,3,3,3,4,4,4,4,4,4,4},
            {4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4},
            {4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4},
            {1,1,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4},
            {0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0},
            {0,0,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,1,2,2,1,1,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,1,1,2,2,1,1,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,1,1,1,1,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,1,1,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=none, 1=bottom-left, 2=bottom-right, 3=top-left, 4=top-right, 5=half
        private static readonly byte[,] PyramidSlopes =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,0,0,4,3,4,3,0,0,0,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,0,0,0,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,0,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,3,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=air, 1=sandstone, 2=cloud
        private static readonly byte[,] PyramidWalls =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,0,2,2,2,2,2,2,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0},
            {0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0},
            {0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0},
            {0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,0,0,0},
            {0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0},
            {0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0},
            {0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0},
            {0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0},
            {0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };


        //0=air, 1=tin/copper, 2=sand, 3=platform, 4=gemspark, 5=water sensor, 6=lava sensor, 7=honey sensor
        static readonly byte[,] SubmarineTiles =
        {
            {0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,1,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,1,0,0,0,0,1,2,2,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,1,0,0,0,0,1,2,2,2,2,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,0,0,0},
            {0,0,0,0,0,2,1,0,0,0,0,1,0,0,0,4,4,4,0,0,0,1,1,0,0},
            {0,0,0,0,0,2,1,0,3,3,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0},
            {0,0,0,0,2,2,1,0,3,3,0,1,0,0,0,0,0,0,0,5,6,7,0,1,4},
            {0,0,0,2,2,2,1,0,3,3,0,1,0,0,0,0,0,0,0,3,3,3,0,1,4},
            {0,0,2,2,2,2,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4},
            {0,2,2,2,2,2,2,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2},
            {2,2,2,2,2,2,2,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,1,2,2},
            {2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2}
        };

        //0=air, 1=tin/copper, 2=stone, 3=glass
        static readonly byte[,] SubmarineWalls =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,0,0,0,0},
            {0,0,0,0,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,0,0,0},
            {0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,1,3,3,3,1,1,1,1,0,0},
            {0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,1,3,3,3,1,1,1,1,0,0},
            {0,0,0,0,1,1,1,2,2,2,2,1,1,1,1,1,3,3,3,1,1,1,1,0,0},
            {0,0,0,0,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,0,0,0},
            {0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };

        //0=none, 1=bottom-left, 2=bottom-right, 3=top-left, 4=top-right, 5=half
        static readonly byte[,] SubmarineSlopes =
        {
            {0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0},
            {0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,4,0,3,0,0,0,4,1,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            {0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3},
            {0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,5},
            {2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,0,2,3,2,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0}
        };

        //0=air, 1=compressor, 2=chest, 3=door, 4=trapdoor
        static readonly byte[,] SubmarineObjects =
        {
            {0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,1,0,0,0,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
        };


        //0=air, 1=dirt, 2=stone brick, 3=demonite brick, 4=platform
        static readonly byte[,] TowerTiles =
        {
            {2,2,2,2,2,2,2,2,2,2,2,2,2,2,2},
			{1,2,2,2,2,2,2,2,2,2,2,2,2,2,1},
			{4,2,2,3,3,3,3,3,3,3,3,3,2,2,4},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,2,2,0,0,0,0,0,0,0,0,0,2,2,0},
			{0,2,2,0,0,0,0,0,0,0,0,0,2,2,0},
			{0,2,2,2,0,0,0,0,0,0,0,2,2,2,0},
			{0,2,2,2,3,3,3,3,4,4,3,2,2,2,0},
			{0,0,0,2,3,0,0,0,0,0,3,2,0,0,0},
			{0,0,0,2,3,0,0,0,0,0,3,2,0,0,0},
			{0,0,0,2,3,0,0,0,0,0,3,2,0,0,0},
			{0,0,2,2,3,3,3,3,4,4,3,2,2,0,0},
			{0,0,2,2,3,0,0,0,0,0,3,2,2,0,0},
			{0,0,0,2,3,0,0,0,0,0,3,2,0,0,0},
			{0,0,0,2,3,0,0,0,0,0,3,2,0,0,0},
			{0,0,2,2,3,3,3,3,4,4,3,2,2,0,0},
			{0,2,2,2,0,0,0,0,0,0,0,2,2,2,0},
			{2,2,2,0,0,0,0,0,0,0,0,0,2,2,2},
			{2,2,2,0,0,0,0,0,0,0,0,0,2,2,2},
			{0,2,2,0,0,0,0,0,0,0,0,0,2,2,0},
			{0,2,2,0,0,0,0,0,0,0,0,0,2,2,0},
			{0,2,2,2,0,0,0,0,0,0,0,2,2,2,0},
			{2,2,2,2,2,2,4,4,4,2,2,2,2,2,2},
			{2,2,0,0,0,0,0,0,0,0,0,0,0,2,2},
			{2,2,0,0,0,0,0,0,0,0,0,0,0,2,2},
			{2,2,0,0,0,0,0,0,0,0,0,0,0,2,2}
        };

        //0=air, 1=stone brick, 2=demonite brick
        static readonly byte[,] TowerWalls =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {0,0,1,1,2,1,1,2,1,1,2,1,1,0,0},
			{0,0,1,1,2,1,1,2,1,1,2,1,1,0,0},
			{0,0,1,1,2,1,1,2,1,1,2,1,1,0,0},
			{0,0,1,1,2,1,1,2,1,1,2,1,1,0,0},
			{0,0,1,1,2,1,1,2,1,1,2,1,1,0,0},
			{0,0,1,1,2,1,1,2,1,1,2,1,1,0,0},
            {0,0,0,1,2,1,1,2,1,1,2,1,0,0,0},
			{0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
			{0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
			{0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
			{0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
			{0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
            {0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
			{0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
			{0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
            {0,0,0,0,2,1,1,2,1,1,2,0,0,0,0},
			{0,0,0,1,2,1,1,1,1,1,2,1,0,0,0},
            {0,0,0,1,2,1,1,1,1,1,2,1,0,0,0},
			{0,0,0,1,2,1,1,1,1,1,2,1,0,0,0},
			{0,0,0,2,2,2,2,2,2,2,2,2,0,0,0},
			{0,0,0,1,2,1,1,1,1,1,2,1,0,0,0},
            {0,0,0,1,2,1,1,1,1,1,2,1,0,0,0},
			{0,0,1,1,1,1,1,1,1,1,1,1,1,0,0},
			{0,0,0,0,1,0,0,1,0,0,1,0,0,0,0},
            {0,0,0,0,1,0,0,1,0,0,1,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        };

        //0=none, 1=bottom-left, 2=bottom-right, 3=top-left, 4=top-right, 5=half
        static readonly byte[,] TowerSlopes =
        {
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{2,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,5,2,0,0,0,0,0,0,0,0,0,1,5,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,2,0,0,0,0,0,0,0,0,0,1,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,4,0,0,0,0,0,0,0,0,0,3,0,0},
			{0,4,0,0,0,0,0,0,0,0,0,0,0,3,0},
			{4,0,0,0,0,0,0,0,0,0,0,0,0,0,3},
			{1,0,0,0,0,0,0,0,0,0,0,0,0,0,2},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,3,0,0,0,0,0,0,0,4,0,0,0},
			{4,0,0,0,0,0,0,0,0,0,0,0,0,0,3},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
			{0,1,0,0,0,0,0,0,0,0,0,0,0,2,0},
        };

        private int BoatPositionX = 0;
        private int BoatPositionY = 0;
        private int CheckTile = TileID.Dirt;
        private int HellLayer = Main.maxTilesY - 200;
        private int PyramidPositionX = 0;
        private int PyramidPositionY = 0;
        private int Size = WorldGen.genRand.Next(6, 10);
        private int SnowHousePositionX = 0;
        private int SnowHousePositionY = 0;
        private int TowerPositionX = 0;
        private int TowerPositionY = 0;

        public override void Initialize()
        {
            GenerateHouse = false;
            GenerateBoat = false;
            GenerateTorment = false;
            GenerateStone = false;
            GeneratePyramid = false;
            savedAdventurer = false;
            GenerateCrystal = false;
            GenerateSubmarine = false;
            GenerateFinder = false;
			GenerateMirrorTower = false;
			GenerateSnowHouse = false;
			DownedAntlionQueen = false;
			DownedTowerKeeper = false;
			DownedBarrier = false;
        }

        public override TagCompound Save()
        {
            var Generated = new BitsByte();
            Generated[0] = GenerateHouse;
            Generated[1] = GenerateBoat;
            Generated[2] = GenerateTorment;
            Generated[3] = GenerateStone;
            Generated[4] = GeneratePyramid;
            Generated[5] = savedAdventurer;
            Generated[6] = GenerateCrystal;
            Generated[7] = GenerateSubmarine;
            Generated[8] = GenerateFinder;
			Generated[9] = GenerateMirrorTower;
			Generated[10] = GenerateSnowHouse;
			var Downed = new List<string>();
            if (DownedAntlionQueen) Downed.Add("antlionQueen");
			if (DownedTowerKeeper) Downed.Add("towerKeeper");
            return new TagCompound
            {
                {
                    "StartPositionX",
                    (object)StartPositionX
                },
                {
                    "StartPositionY",
                    (object)StartPositionY
                },
                {
                    "Generated",
                    (byte)Generated
                },
				{
                    "Misc",
                    (byte)Generated
                },
                {
                    "Version", 0
                },
				{
                    "Downed", Downed
                }
            };
        }

        public override void Load(TagCompound tag)
        {
            var Generated = (BitsByte)tag.GetByte("Generated");
            GenerateHouse = Generated[0];
            GenerateBoat = Generated[1];
            GenerateTorment = Generated[2];
            GenerateStone = Generated[3];
            GeneratePyramid = Generated[4];
            savedAdventurer = Generated[5];
            GenerateCrystal = Generated[6];
            GenerateSubmarine = Generated[7];
            GenerateFinder = Generated[8];
			GenerateMirrorTower = Generated[9];
			GenerateSnowHouse = Generated[10];
            StartPositionX = tag.GetInt("StartPositionX");
            StartPositionY = tag.GetInt("StartPositionY");
            var Downed = tag.GetList<string>("Downed");
            DownedAntlionQueen = Downed.Contains("antlionQueen");
			DownedTowerKeeper = Downed.Contains("towerKeeper");
        }

        public override void LoadLegacy(BinaryReader reader)
        {
            int loadVersion = reader.ReadInt32();
            if (loadVersion == 0)
            {
                BitsByte Flags1 = reader.ReadByte();
                DownedAntlionQueen = Flags1[8];
				DownedTowerKeeper = Flags1[12];
                StartPositionX = reader.ReadInt32();
                StartPositionY = reader.ReadInt32();
            }
        }

        public override void NetSend(BinaryWriter writer)
        {
            BitsByte Flags1 = new BitsByte();
			BitsByte Flags2 = new BitsByte();
            Flags1[0] = GenerateHouse;
            Flags1[1] = GenerateBoat;
            Flags1[2] = GenerateTorment;
            Flags1[3] = GenerateStone;
            Flags1[4] = GeneratePyramid;
            Flags1[5] = savedAdventurer;
            Flags1[6] = GenerateCrystal;
            Flags1[7] = GenerateSubmarine;
            Flags1[8] = GenerateFinder;
			Flags1[9] = GenerateMirrorTower;
			Flags1[10] = GenerateSnowHouse;
			Flags2[0] = DownedAntlionQueen;
			Flags2[1] = DownedTowerKeeper;
            writer.Write(Flags1);
			writer.Write(Flags2);
            writer.Write(StartPositionX);
            writer.Write(StartPositionY);
        }

        public override void NetReceive(BinaryReader reader)
        {
            BitsByte Flags1 = reader.ReadByte();
            BitsByte Flags2 = reader.ReadByte();
            GenerateHouse = Flags1[0];
            GenerateBoat = Flags1[1];
            GenerateTorment = Flags1[2];
            GenerateStone = Flags1[3];
            GeneratePyramid = Flags1[4];
            savedAdventurer = Flags1[5];
            GenerateCrystal = Flags1[6];
            GenerateSubmarine = Flags1[7];
            GenerateFinder = Flags1[8];
			GenerateMirrorTower = Flags1[9];
			GenerateSnowHouse = Flags1[10];
			
			DownedAntlionQueen = Flags2[0];
			DownedTowerKeeper = Flags2[1];
            StartPositionX = reader.ReadInt32();
            StartPositionY = reader.ReadInt32();
        }

        public override void PostUpdate()
        {
            for (var k = 0; k < 200; k++)
            {
                if (NPC.AnyNPCs(mod.NPCType("UnconsciousGuide")))
                {
                    if (Main.npc[k].type == NPCID.Guide && Main.npc[k].active)
                    {
                        Main.npc[k].life = -1;
                        Main.npc[k].active = false;
                        Main.npc[k].checkDead();
                    }
                }
            }         
        }

        public override void ModifyWorldGenTasks(List<GenPass> tasks, ref float totalWeight)
        {
            var index = tasks.FindIndex(x => x.Name == "Planting Trees");
            if (index != -1)
            {
                tasks.Add(new PassLegacy("[Antiaris] Snow House", AddSnowHouse));
                tasks.Add(new PassLegacy("[Antiaris] Chest Finder", AddChestFinder));
                tasks.Add(new PassLegacy("[Antiaris] Guide House", AddGuideHouse));
				tasks.Add(new PassLegacy("[Antiaris] Cursed Tower", AddTower));
            }
            index = tasks.FindIndex(x => x.Name == "Micro Biomes");
            if (index != -1)
            {
                tasks.Add(new PassLegacy("[Antiaris] Submarine", AddSubmarine));
                tasks.Add(new PassLegacy("[Antiaris] Pirate Boat", AddBoat));
            }
            index = tasks.FindIndex(genPass => genPass.Name == "Gems");
            if (index != -1)
            {
                tasks.Add(new PassLegacy("[Antiaris] Nature Crystals", AddNatureCrystal));
                tasks.Add(new PassLegacy("[Antiaris] Enchanted Stones", AddStone));
            }
            index = tasks.FindIndex(x => x.Name == "Floating Islands");
            if (index != -1)
            {
                tasks.Add(new PassLegacy("[Antiaris] Pyramid", AddPyramid));
            }
        }

        public void AddGuideHouse(GenerationProgress progress = null)
        {
            if (GenerateHouse)
            {
                return;
            }
            try
            {
                bool Success = do_MakeGuideHouse(progress);
                if (Success)
                {
                    GenerateHouse = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddBoat(GenerationProgress progress = null)
        {
            if (GenerateBoat)
            {
                return;
            }
            try
            {
                bool Success = do_MakePirateBoat(progress);
                if (Success)
                {
                    GenerateBoat = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddStone(GenerationProgress progress = null)
        {
            if (GenerateStone)
            {
                return;
            }
            try
            {
                bool Success = do_MakeEnchantedStones(progress);
                if (Success)
                {
                    GenerateStone = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddPyramid(GenerationProgress progress = null)
        {
            if (GeneratePyramid)
            {
                return;
            }
            try
            {
                bool Success = do_MakeSandPyramid(progress);
                if (Success)
                {
                    GeneratePyramid = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddNatureCrystal(GenerationProgress progress = null)
        {
            if (GenerateCrystal)
            {
                return;
            }
            try
            {
                bool Success = do_MakeNatureCrystal(progress);
                if (Success)
                {
                    GenerateCrystal = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddSnowHouse(GenerationProgress progress = null)
        {
            if (GenerateSnowHouse)
            {
                return;
            }
            try
            {
                bool Success = do_MakeSnowHouse(progress);
                if (Success)
                {
                    GenerateSnowHouse = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddSubmarine(GenerationProgress progress = null)
        {
            if (GenerateSubmarine)
            {
                return;
            }
            try
            {
                bool Success = do_MakeSunkenSubmarine(progress);
                if (Success)
                {
                    GenerateSubmarine = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddChestFinder(GenerationProgress progress = null)
        {
            if (GenerateFinder)
            {
                return;
            }
            try
            {
                bool Success = do_MakeChestFinder(progress);
                if (Success)
                {
                    GenerateFinder = true;
                }
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        public void AddTower(GenerationProgress progress = null)
        {
            if (GenerateMirrorTower)
            {
                return;
            }
            try
            {
                bool Success = do_MakeTheTower(progress);
                if (Success)
                {
                    GenerateMirrorTower = true;
                }
                leaf(progress);
            }
            catch (Exception exception)
            {
                Main.NewText("Oh no, an error happened! Report this to Zerokk and send him the file Terraria/ModLoader/Logs/Logs.txt");
                ErrorLogger.Log(exception);
            }
        }

        bool do_MakeSnowHouse(GenerationProgress progress)
        {
			string SnowHouseGen = Language.GetTextValue("Mods.Antiaris.SnowHouseGen");
            if (progress != null)
            {
                progress.Message = SnowHouseGen;
                progress.Set(0.33f);
            }
            List<Point> list = new List<Point>();
            for (int i = Main.maxTilesX / 5; i < Main.maxTilesX / 5 * 4; i++)
            {
                int y = 200;
                while (!WorldGen.SolidOrSlopedTile(i, y + 1))
                    y++;
                bool flag = true;
                for (int j = 0; j < 26; j++)
                    if (!WorldGen.SolidOrSlopedTile(i + j, y + 1) || Main.tile[i + j, y + 1].type != 147)
                        flag = false;
                if (flag)
                    for (int k = 1; k < 10; k++)
                        if (WorldGen.SolidOrSlopedTile(i - 1, y - k) || WorldGen.SolidOrSlopedTile(i + 8, y - k))
                            flag = false;
                    if (flag)
                        list.Add(new Point(i, y));
            }
            if (list.Count > 0)
            {
                Point point = list[WorldGen.genRand.Next(0, list.Count<Point>())];
                SnowHousePositionX = point.X;
                SnowHousePositionY = point.Y;
            }
            goto GenerateBuild;
            AntiarisHelper.Log("Continue...");
            return false;

            GenerateBuild:
            AntiarisHelper.Log("Generating snow house...");
            var SpawnAdventurer = NPC.NewNPC((SnowHousePositionX + 17) * 16, (SnowHousePositionY - 5) * 16, ModLoader.GetMod("Antiaris").NPCType("FrozenAdventurer"), 0, 0f, 0f, 0f, 0f, 255);
            Main.npc[SpawnAdventurer].homeTileX = -1;
            Main.npc[SpawnAdventurer].homeTileY = -1;
            Main.npc[SpawnAdventurer].direction = 1;
            Main.npc[SpawnAdventurer].homeless = false;
            for (var X = 0; X < SnowHouseTiles.GetLength(1); X++)
            {
                for (var Y = 0; Y < SnowHouseTiles.GetLength(0); Y++)
                {
					var tile = Framing.GetTileSafely(SnowHousePositionX + X, SnowHousePositionY - Y);
                    switch (SnowHouseTiles[Y, X])
                    {
                        case 0:
                            break;
                        case 1:
                            tile.type = 147;
                            tile.active(true);
                            break;
                        case 2:
                            tile.type = 321;
                            tile.active(true);
                            break;
						case 3:
                            tile.type = 124;
                            tile.active(true);
                            break;
						case 4:
                            tile.type = 54;
                            tile.active(true);
                            break;
						case 5:
                            WorldGen.PlaceTile(SnowHousePositionX + X, SnowHousePositionY - Y, TileID.Platforms, true, true, -1, 19);
                            WorldGen.SlopeTile(SnowHousePositionX + X, SnowHousePositionY - Y, -1);
                            break;
						case 6:
                            tile.type = 51;
							tile.active(true);
                            break;
                        case 7:
                            WorldGen.KillTile(SnowHousePositionX + X, SnowHousePositionY - Y, false, false, false);
                            break;
                    }
                    switch (SnowHouseWalls[Y, X])
                    {
                        case 0:
                            tile.wall = 0;
                            break;
                        case 1:
                            tile.wall = 149;
                            break;
                        case 2:
                            tile.wall = 4;
                            break;
                        case 3:
                            tile.wall = 78;
                            break;
						case 4:
                            tile.wall = 150;
                            break;
						case 5:
                            tile.wall = 21;
                            break;
                    }
                    if (SnowHouseSlopes[Y, X] == 5)
                    {
                        tile.halfBrick(true);
                    }
                    else
                    {
                        tile.halfBrick(false);
                        tile.slope(SnowHouseSlopes[Y, X]);
                    }
                }
            }
			WorldGen.PlaceObject(SnowHousePositionX + 11, SnowHousePositionY - 5, 10, true, 30);
			WorldGen.PlaceObject(SnowHousePositionX + 18, SnowHousePositionY - 8, 50, true);
			WorldGen.PlaceObject(SnowHousePositionX + 19, SnowHousePositionY - 8, 78, true);
			WorldGen.PlaceObject(SnowHousePositionX + 25, SnowHousePositionY - 5, TileID.Chairs, true, 30, 1);
			WorldGen.PlaceObject(SnowHousePositionX + 23, SnowHousePositionY - 8, 246, true, 3);
			WorldGen.PlaceObject(SnowHousePositionX + 19, SnowHousePositionY - 5, ModLoader.GetMod("Antiaris").TileType("SnowSofa"));
			WorldGen.PlaceObject(SnowHousePositionX + 13, SnowHousePositionY - 5, ModLoader.GetMod("Antiaris").TileType("SnowWorkBench"));
			WorldGen.PlaceObject(SnowHousePositionX + 23, SnowHousePositionY - 5, ModLoader.GetMod("Antiaris").TileType("SnowFireplace"));
			WorldGen.PlaceObject(SnowHousePositionX + 6, SnowHousePositionY - 3, ModLoader.GetMod("Antiaris").TileType("SteelShovel"));
			WorldGen.PlaceChest(SnowHousePositionX + 19, SnowHousePositionY - 11, 21, true);
			var SnowChestIndex = Chest.FindChest(SnowHousePositionX + 19, SnowHousePositionY - 12);
            if (SnowChestIndex != -1)
            {
				do_SnowHouseLoot(Main.chest[SnowChestIndex].item);
            }
            return true;
        }

        bool do_MakeGuideHouse(GenerationProgress progress)
        {
			string GuideHouseGen = Language.GetTextValue("Mods.Antiaris.GuideHouseGen");
            if (progress != null)
            {
                progress.Message = GuideHouseGen;
                progress.Set(0.1f);
            }
            StartPositionX = WorldGen.genRand.Next(Main.maxTilesX / 2 + 5, Main.spawnTileX + 50);
            for (var Attempts = 0; Attempts < 10000; Attempts++)
            {
                for (var i = 0; i < 25; i++)
                {
                    StartPositionY = 190;
                    do
                    {
                        StartPositionY++;
                    }
                    while ((!Main.tile[StartPositionX + i, StartPositionY].active() && StartPositionY < Main.worldSurface) || Main.tile[StartPositionX + i, StartPositionY].type == TileID.Trees || Main.tile[StartPositionX + i, StartPositionY].type == 27);
                    if (!Main.tile[StartPositionX, StartPositionY].active() || Main.tile[StartPositionX, StartPositionY].liquid > 0)
                    {
                        StartPositionX++;
                    }
                    if (Main.tile[StartPositionX + i, StartPositionY].active())
                    {
						if (Main.tile[StartPositionX, StartPositionY].liquid > 0)
							StartPositionX = WorldGen.genRand.Next(Main.maxTilesX / 2 + 5, Main.spawnTileX + 50);
                        goto GenerateBuild;
                    }
                }
            }
            AntiarisHelper.Log("Continue...");
            return false;

            GenerateBuild:
            AntiarisHelper.Log("Generating guide house...");
            var SpawnGuide = NPC.NewNPC((StartPositionX + 15) * 16, (StartPositionY - 6) * 16, ModLoader.GetMod("Antiaris").NPCType("UnconsciousGuide"), 0, 0f, 0f, 0f, 0f, 255);
            Main.npc[SpawnGuide].homeTileX = -1;
            Main.npc[SpawnGuide].homeTileY = -1;
            Main.npc[SpawnGuide].direction = 1;
            Main.npc[SpawnGuide].homeless = false;
            for (var t = 0; t < 6; t++)
            {
                if (Main.tile[StartPositionX, StartPositionY + t].type == TileID.SnowBlock)
                {
                    CheckTile = TileID.SnowBlock;
                    ChestType = (ushort)ModLoader.GetMod("Antiaris").TileType("BorealWoodCabinet");
                    Bed = 24;
                    Wood = 321;
                    WoodWall = 149;
                    StoneWall = 84;
                    Brick = 206;
                    WoodTile = 150;
                    Table = 28;
                    Door = 30;
                    Platform = 19;
                    Chair = 60;
                    Stone = TileID.IceBlock;
                    Grass = TileID.SnowBlock;
                    Fence = WallID.BorealWoodFence;
                    Mailbox = (ushort)ModLoader.GetMod("Antiaris").TileType("BorealMailbox");
                    Dray = (ushort)ModLoader.GetMod("Antiaris").TileType("BorealLeafDray");
                }
                if (Main.tile[StartPositionX, StartPositionY + t].type == TileID.Dirt)
                {
                    CheckTile = TileID.Dirt;
                    ChestType = (ushort)ModLoader.GetMod("Antiaris").TileType("Cabinet");
                    Bed = 0;
                    Wood = TileID.WoodBlock;
                    WoodWall = 4;
                    StoneWall = 5;
                    Brick = 38;
                    WoodTile = 106;
                    Door = 0;
                    Table = 0;
                    Platform = 0;
                    Chair = 0;
                    Mailbox = (ushort)ModLoader.GetMod("Antiaris").TileType("Mailbox");
                    Stone = TileID.Stone;
                    Grass = 2;
                    Fence = 106;
                    Dray = (ushort)ModLoader.GetMod("Antiaris").TileType("LeafDray");
                }
                if (Main.tile[StartPositionX, StartPositionY + t].type == TileID.IceBlock)
                {
                    CheckTile = TileID.SnowBlock;
                    ChestType = (ushort)ModLoader.GetMod("Antiaris").TileType("BorealWoodCabinet");
                    Mailbox = (ushort)ModLoader.GetMod("Antiaris").TileType("BorealMailbox");
                    Bed = 24;
                    Wood = 321;
                    WoodWall = 149;
                    StoneWall = 84;
                    Brick = 206;
                    WoodTile = 150;
                    Table = 28;
                    Door = 60;
                    Platform = 19;
                    Chair = 30;
                    Stone = TileID.IceBlock;
                    Grass = TileID.SnowBlock;
                    Fence = WallID.BorealWoodFence;
                    Dray = (ushort)ModLoader.GetMod("Antiaris").TileType("BorealLeafDray");
                }
            }
            StartPositionY += 3;
            for (var X = 0; X < GuideHouse.GetLength(1); X++)
            {
                for (var Y = 0; Y < GuideHouse.GetLength(0); Y++)
                {
                    var tile = Framing.GetTileSafely(StartPositionX + X, StartPositionY - Y);
                    switch (GuideHouse[Y, X])
                    {
                        case 0:
                            break;
                        case 1:
                            tile.type = (ushort)CheckTile;
                            tile.active(true);
                            break;
                        case 2:
                            tile.type = (ushort)Wood;
                            tile.active(true);
                            break;
                        case 3:
                            tile.type = (ushort)Brick;
                            tile.active(true);
                            break;
                        case 4:
                            tile.type = (ushort)Stone;
                            tile.active(true);
                            break;
						case 5:
							WorldGen.PlaceTile(StartPositionX + X, StartPositionY - Y, TileID.Platforms, true, true, -1, Platform);
							break;
						case 6:
                            tile.type = (ushort)StoneSlab;
                            tile.active(true);
                            break;
						case 7:
                            tile.type = (ushort)Grass;
                            tile.active(true);
                            break;
                        case 8:
                            WorldGen.KillTile(StartPositionX + X, StartPositionY - Y, false, false, false);
                            break;
                    }
                    switch (GuideHouseWall[Y, X])
                    {
                        case 0:
                            tile.wall = 0;
                            break;
                        case 1:
                            tile.wall = (ushort)StoneWall;
                            break;
                        case 2:
                            tile.wall = (ushort)WoodWall;
                            break;
                        case 3:
                            tile.wall = (ushort)LivingWoodWall;
                            break;
						case 4:
							tile.wall = (ushort)PlankedWall;
							break;
						case 5:
							tile.wall = (ushort)StoneSlabWall;
							break;
						case 6:
							tile.wall = (ushort)Fence;
							break;
                    }
                    if (GuideHouseSlopes[Y, X] == 5)
                    {
                        tile.halfBrick(true);
                    }
                    else
                    {
                        tile.halfBrick(false);
                        tile.slope(GuideHouseSlopes[Y, X]);
                    }
					WorldGen.PlaceObject(StartPositionX + 11, StartPositionY - 13, 79, true, Bed);
					WorldGen.PlaceChest(StartPositionX + 14, StartPositionY - 13, (ushort)ChestType);
					var ChestIndex2 = Chest.FindChest(StartPositionX + 14, StartPositionY - 14);
                    if (ChestIndex2 != -1)
                    {
                        do_GuideHouseLoot2(Main.chest[ChestIndex2].item);
                    }
					WorldGen.PlaceObject(StartPositionX + 11, StartPositionY - 11, 42, true, 3);
					WorldGen.PlaceObject(StartPositionX + 14, StartPositionY - 15, 78, true);
					WorldGen.PlaceObject(StartPositionX + 8, StartPositionY - 5, 387, true);
					WorldGen.PlaceObject(StartPositionX + 11, StartPositionY - 6, 14, true, Table);
					WorldGen.PlaceObject(StartPositionX + 11, StartPositionY - 8, 103, true);
					WorldGen.PlaceObject(StartPositionX + 8, StartPositionY - 10, 50, true);
					WorldGen.PlaceObject(StartPositionX + 9, StartPositionY - 10, 13, true, 1);
					WorldGen.PlaceObject(StartPositionX + 15, StartPositionY - 10, 246, true, 3);
					WorldGen.PlaceObject(StartPositionX + 1, StartPositionY - 5, Mailbox);
					WorldGen.PlaceObject(StartPositionX + 22, StartPositionY - 6, Dray);
					WorldGen.PlaceObject(StartPositionX + 19, StartPositionY - 6, 10, true, Door);
                    WorldGen.KillTile(StartPositionX + 11, StartPositionY - 2, false, false, true);
                    WorldGen.KillTile(StartPositionX + 12, StartPositionY - 2, false, false, true);
                    WorldGen.KillTile(StartPositionX + 11, StartPositionY - 3, false, false, true);
                    WorldGen.KillTile(StartPositionX + 12, StartPositionY - 3, false, false, true);
                    WorldGen.KillTile(StartPositionX + 10, StartPositionY - 2, false, false, true);
                    WorldGen.KillTile(StartPositionX + 9, StartPositionY - 2, false, false, true);
                    WorldGen.KillTile(StartPositionX + 10, StartPositionY - 3, false, false, true);
                    WorldGen.KillTile(StartPositionX + 9, StartPositionY - 3, false, false, true);
                    WorldGen.KillTile(StartPositionX + 8, StartPositionY - 2, false, false, true);
                    WorldGen.KillTile(StartPositionX + 8, StartPositionY - 3, false, false, true);
                    WorldGen.PlaceChest(StartPositionX + 11, StartPositionY - 2, 21, true, 28);
					var ChestIndex1 = Chest.FindChest(StartPositionX + 11, StartPositionY - 3);
                    if (ChestIndex1 != -1)
                    {
                        do_GuideHouseLoot(Main.chest[ChestIndex1].item);
                    }
                }
            }
            return true;
        }

        bool do_MakePirateBoat(GenerationProgress progress)
        {
			string PirateBoatGen = Language.GetTextValue("Mods.Antiaris.PirateBoatGen");
            if (progress != null)
            {
                progress.Message = PirateBoatGen;
                progress.Set(0.33f);
            }      
            for (var Attempts = 0; Attempts < 10000; Attempts++)
            {
                BoatPositionX = 75;
                BoatPositionY = 0;
                do
                {
                    BoatPositionY++;
                }
                while (Main.tile[BoatPositionX, BoatPositionY].liquid < 1);
                if (Main.tile[BoatPositionX, BoatPositionY].liquid > 0)
                {        
                    goto GenerateBuild;
                }
            }
            AntiarisHelper.Log("Continue...");
            return false;

            GenerateBuild:
            AntiarisHelper.Log("Generating pirate boat...");
            var SpawnPirate = NPC.NewNPC((BoatPositionX + 5) * 16, (BoatPositionY - 2) * 16, ModLoader.GetMod("Antiaris").NPCType("BoundPirate"), 0, 0f, 0f, 0f, 0f, 255);
            Main.npc[SpawnPirate].homeTileX = -1;
            Main.npc[SpawnPirate].homeTileY = -1;
            Main.npc[SpawnPirate].direction = 1;
            Main.npc[SpawnPirate].homeless = false;
            for (var X = 0; X < BoatTiles.GetLength(1); X++)
            {
                for (var Y = 0; Y < BoatTiles.GetLength(0); Y++)
                {
                    var tile = Framing.GetTileSafely(BoatPositionX + X, BoatPositionY + 2 - Y);
                    if (tile.liquid > 0)
                        tile.liquid = 0;
                    switch (BoatTiles[Y, X])
                    {
                        case 0:
                            tile.active(false);
                            break;
                        case 1:
                            tile.type = 253;
                            tile.active(true);
                            tile.color(28);
                            break;
                        case 2:
                            tile.type = 124;
                            tile.active(true);
                            break;
                    }
                    switch (BoatWalls[Y, X])
                    {
                        case 0:
                            tile.wall = 0;
                            break;
                        case 1:
                            tile.wall = 115;
                            tile.wallColor(28);
                            break;
                        case 2:
                            tile.wall = 138;
                            tile.wallColor(28);
                            break;
                        case 3:
                            tile.wall = 148;
                            break;
                    }
                    if (BoatSlopes[Y, X] == 5)
                    {
                        tile.halfBrick(true);
                    }
                    else
                    {
                        tile.halfBrick(false);
                        tile.slope(BoatSlopes[Y, X]);
                    }
                    if (BoatNoneActive[Y, X] == 1)
                    {	
                        tile.inActive(true);
                    }
                    else
                    {
                        tile.inActive(false);
                    }
                }
            }
            for (var X = 0; X < BoatTiles.GetLength(1); X++)
            {
                for (var Y = 0; Y < BoatTiles.GetLength(0); Y++)
                {
                    var tile = Framing.GetTileSafely(BoatPositionX + X, BoatPositionY + 2 - Y);
                    switch (BoatObjects[Y, X])
                    {
                        case 0:
                            break;
                        case 1:
                            WorldGen.PlaceObject(BoatPositionX + X, BoatPositionY + 2 - Y, 42, true, 6);
                            break;
                        case 2:
                            WorldGen.PlaceObject(BoatPositionX + X, BoatPositionY + 2 - Y, TileID.TrapdoorClosed);
                            break;
                        case 3:
                            WorldGen.PlaceObject(BoatPositionX + X, BoatPositionY + 2 - Y, 42, true, 4);
                            break;
                        case 4:
                            WorldGen.PlaceTile(BoatPositionX + X, BoatPositionY + 2 - Y, TileID.Platforms, true, true, -1, 16);
                            tile.color(28);
                            break;
                        case 5:
                            WorldGen.PlaceObject(BoatPositionX + X, BoatPositionY + 2 - Y, 376);
                            break;
                        case 6:
                            WorldGen.PlaceObject(BoatPositionX + X, BoatPositionY + 2 - Y, 101);
                            break;
                        case 7:
                            WorldGen.PlaceObject(BoatPositionX + X, BoatPositionY + 2 - Y, TileID.Kegs);
                            break;
                        case 8:
                            WorldGen.PlaceObject(BoatPositionX + X, BoatPositionY + 2 - Y, 13);
                            break;
                        case 9:
                            WorldGen.PlaceChest(BoatPositionX + X, BoatPositionY + 2 - Y, 21, false, 5);
                            var ChestIndex = Chest.FindChest(BoatPositionX + X, BoatPositionY + 1 - Y);
                            if (ChestIndex != -1)
                            {
                                do_PirateBoatLoot(Main.chest[ChestIndex].item);
                            }
                            break;
                    }
                }
            }
            return true;
        }

        bool do_MakeEnchantedStones(GenerationProgress progress)
        {
            string EnchantedGen = Language.GetTextValue("Mods.Antiaris.EnchantedGen");
            if (progress != null)
            {
                progress.Message = EnchantedGen;
                progress.Set(0.41f);
            }
            goto GenerateEnchanted;
            AntiarisHelper.Log("Continue...");
            return false;

            GenerateEnchanted:
            AntiarisHelper.Log("Generating enchanted stones...");
            for (var j = 0.0; j < (double)((Main.maxTilesX - 200) * (int)((double)Main.maxTilesY * 0.300000011920929)) / 7250.0; ++j)
            {
				var x = WorldGen.genRand.Next(100, Main.maxTilesX - 100);
				var y = WorldGen.genRand.Next((int)((double)Main.maxTilesY * 0.349999994039536), Main.maxTilesY - 300);
				if ((int)Main.tile[x, y].type != 44 && (int)Main.tile[x, y].type != 41 && (int)Main.tile[x, y].type != 226 && (int)Main.tile[x, y].type != 43 && (int)Main.tile[x, y].type != 314 && (int)Main.tile[x, y].type != 53 && (int)Main.tile[x, y].type != 147 && (int)Main.tile[x, y].type != 161 && (int)Main.tile[x, y].type != 59)
				{
					WorldGen.TileRunner(x, y, (double)WorldGen.genRand.Next(3, 6), WorldGen.genRand.Next(3, 6), (ushort)ModLoader.GetMod("Antiaris").TileType("EnchantedStone"), false, 0.0f, 0.0f, false, true);
				}
            }
            return true;
        }

        bool do_MakeSandPyramid(GenerationProgress progress)
        {
            string PyramideGen = Language.GetTextValue("Mods.Antiaris.PyramideGen");
            if (progress != null)
            {
                progress.Message = PyramideGen;
                progress.Set(0.62f);
            }
            PyramidPositionX = WorldGen.genRand.Next(WorldGen.UndergroundDesertLocation.X - 25, WorldGen.UndergroundDesertLocation.X + 200);
            PyramidPositionY = 185;
            for (var Attempts = 0; Attempts < 10000; Attempts++)
            {
                for (var X = PyramidPositionX - 20; X < PyramidPositionX + 20; X++)
                {
                    for (var Y = PyramidPositionY - 20; Y < PyramidPositionY + 20; Y++)
                    {
                        if (Main.tile[X, Y].active() || Main.tile[X, Y].wall != 0)
                        {
                            goto NextAttempt;
                        }
                    }
                }
                goto Pyramid;
                NextAttempt:;
            }
            AntiarisHelper.Log("Continue...");
            return false;

            Pyramid:
            AntiarisHelper.Log("Generating pyramid...");
            for (var X = 0; X < PyramidTiles.GetLength(1); X++)
            {
                for (var Y = 0; Y < PyramidTiles.GetLength(0); Y++)
                {
                    var tile = Framing.GetTileSafely(PyramidPositionX + X, PyramidPositionY - Y);
                    if (Framing.GetTileSafely(PyramidPositionX + X + 1, PyramidPositionY - Y).active() && Framing.GetTileSafely(PyramidPositionX + X - 1, PyramidPositionY - Y).active() && Framing.GetTileSafely(PyramidPositionX + X, PyramidPositionY - Y + 1).active() && Framing.GetTileSafely(PyramidPositionX + X, PyramidPositionY - Y - 1).active())
                    {
                        WorldGen.PlaceWall(PyramidPositionX + X, PyramidPositionY - Y, 73);
                    }
                    switch (PyramidTiles[Y, X])
                    {
                        case 0:
                            if (tile.liquid > 0)
                                tile.liquid = 0;
                            WorldGen.KillTile(PyramidPositionX + X, PyramidPositionY - Y, false, false, true);
                            break;
                        case 1:
                            WorldGen.KillTile(PyramidPositionX + X, PyramidPositionY - Y, false, false, true);
                            break;
                        case 2:
                            tile.type = 151;
                            tile.active(true);
                            break;
                        case 3:
                            tile.type = TileID.Sand;
                            tile.active(true);
                            break;
                        case 4:
                            tile.type = 189;
                            tile.active(true);
                            break;
                        case 5:
                            tile.type = 404;
                            tile.active(true);
                            break;
                    }
                    switch (PyramidWalls[Y, X])
                    {
                        case 0:
                            tile.wall = 0;
                            break;
                        case 1:
                            tile.wall = 34;
                            break;
                        case 2:
                            tile.wall = 73;
                            break;
                    }
                    if (PyramidSlopes[Y, X] == 5)
                    {
                        tile.halfBrick(true);
                    }
                    else
                    {
                        tile.halfBrick(false);
                        tile.slope(PyramidSlopes[Y, X]);
                    }
                    WorldGen.PlaceChest(PyramidPositionX + 30, PyramidPositionY - 28, 21, true, 1);
                    var ChestIndex = Chest.FindChest(PyramidPositionX + 30, PyramidPositionY - 29);
                    if (ChestIndex != -1)
                    {
                        do_PyramidLoot(Main.chest[ChestIndex].item);
                    }
                    WorldGen.PlaceObject(PyramidPositionX + 26, PyramidPositionY - 24, 91, true, 4);
                    WorldGen.PlaceObject(PyramidPositionX + 35, PyramidPositionY - 24, 91, true, 5);
                    WorldGen.PlaceObject(PyramidPositionX + 27, PyramidPositionY - 21, 135);
                    WorldGen.PlaceObject(PyramidPositionX + 34, PyramidPositionY - 21, 135);
                    Main.tile[PyramidPositionX + 27, PyramidPositionY - 18].active(false);
                    Main.tile[PyramidPositionX + 28, PyramidPositionY - 18].active(false);
                    Main.tile[PyramidPositionX + 33, PyramidPositionY - 18].active(false);
                    Main.tile[PyramidPositionX + 34, PyramidPositionY - 18].active(false);
                    WorldGen.PlaceObject(PyramidPositionX + 27, PyramidPositionY - 18, 443);
                    WorldGen.PlaceObject(PyramidPositionX + 33, PyramidPositionY - 18, 443);
                    Main.tile[PyramidPositionX + 27, PyramidPositionY - 21].wire(true);
                    Main.tile[PyramidPositionX + 27, PyramidPositionY - 20].wire(true);
                    Main.tile[PyramidPositionX + 27, PyramidPositionY - 19].wire(true);
                    Main.tile[PyramidPositionX + 27, PyramidPositionY - 18].wire(true);
                    Main.tile[PyramidPositionX + 34, PyramidPositionY - 21].wire(true);
                    Main.tile[PyramidPositionX + 34, PyramidPositionY - 20].wire(true);
                    Main.tile[PyramidPositionX + 34, PyramidPositionY - 19].wire(true);
                    Main.tile[PyramidPositionX + 34, PyramidPositionY - 18].wire(true);
                    WorldGen.PlaceWall(PyramidPositionX + 27, PyramidPositionY - 18, 34);
                    WorldGen.PlaceWall(PyramidPositionX + 28, PyramidPositionY - 18, 34);
                    WorldGen.PlaceWall(PyramidPositionX + 33, PyramidPositionY - 18, 34);
                    WorldGen.PlaceWall(PyramidPositionX + 34, PyramidPositionY - 18, 34);
                    WorldGen.PlantCactus(PyramidPositionX + 9, PyramidPositionY - 22);
                    WorldGen.PlantCactus(PyramidPositionX + 14, PyramidPositionY - 21);
                    WorldGen.PlantCactus(PyramidPositionX + 3, PyramidPositionY - 21);
                    WorldGen.PlantCactus(PyramidPositionX + 48, PyramidPositionY - 21);
                    WorldGen.PlantCactus(PyramidPositionX + 59, PyramidPositionY - 21);
                }
            }
            return true;
        }

        bool do_MakeNatureCrystal(GenerationProgress progress)
        {
            string CrystalGen = Language.GetTextValue("Mods.Antiaris.CrystalGen");
            if (progress != null)
            {
                progress.Message = CrystalGen;
                progress.Set(0.79f);
            }
            AntiarisHelper.Log("Generating nature crystals...");
            goto GenerateCrystal;
            AntiarisHelper.Log("Continue...");
            return false;

            //thanks graydee
            GenerateCrystal:
            var X = 1;
            var Y = 1;
            var widthScale = (Main.maxTilesX / 4200f);
            var numberToGenerate = 1;
            for (var k = 0; k < numberToGenerate; k++)
            {
                var placement = false;
                var placed = false;
                while (!placed)
                {
                    var success = false;
                    var attempts = 0;
                    while (!success)
                    {
                        attempts++;
                        if (attempts > 1000)
                        {
                            success = true;
                            continue;
                        }
                        var i = WorldGen.genRand.Next(200, Main.maxTilesX - 200);
                        if (i <= Main.maxTilesX / 2 - 50 || i >= Main.maxTilesX / 2 + 50)
                        {
                            var j = 0;
                            while (!Main.tile[i, j].active() && (double)j < Main.worldSurface)
                            {
                                j++;
                            }
                            if (Main.tile[i, j].type == 2 || Main.tile[i, j].type == 0)
                            {
                                j--;
                                if (j > 150)
                                {
                                    placement = AntiarisHelper.Placement(i, j);
                                    if (placement)
                                    {
                                        X = i;
                                        Y = j;
                                        for (var I = 0; I < 250; I++)
                                        {
                                            var why = Main.rand.Next(-15, 15);
                                            var ex = Main.rand.Next(-40, 40);
                                            WorldGen.PlaceObject(i + ex, j + why, ModLoader.GetMod("Antiaris").TileType("NatureCrystal"));
                                        }
                                        success = true;
                                        placed = true;
                                        continue;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            return true;
        }

        bool leaf(GenerationProgress progress)
        {
            goto GenerateLeaf;
            AntiarisHelper.Log("Continue...");
            return false;

            //thanks graydee
            GenerateLeaf:
            var X = 1;
            var Y = 1;
            var widthScale = (Main.maxTilesX / 4200f);
            var numberToGenerate = 65 * widthScale;
            for (var k = 0; k < numberToGenerate; k++)
            {
                var placed = false;
                while (!placed)
                {
                    var success = false;
                    var attempts = 0;
                    while (!success)
                    {
                        attempts++;
                        if (attempts > 1000)
                        {
                            success = true;
                            continue;
                        }
                        var i = WorldGen.genRand.Next(250, Main.maxTilesX - 250);
                        var j = 0;
                        while (!Main.tile[i, j].active() && (double)j < Main.worldSurface)
                        {
                            j++;
                        }
                        if (Main.tile[i, j].type == 2 || Main.tile[i, j].type == 0)
                        {
                            j--;
                            if (j > 150)
                            {
                                X = i;
                                Y = j;
                                WorldGen.PlaceWall(i, j + 1, 60);
                                WorldGen.PlaceWall(i - 1, j + 1, 60);
                                WorldGen.PlaceWall(i, j, 60);
                                WorldGen.PlaceWall(i + 1, j, 60);
                                success = true;
                                placed = true;
                                continue;
                            }
                        }
                    }
                }
            }
            return true;
        }

        bool do_MakeSunkenSubmarine(GenerationProgress progress)
        {
            string SubmarineGen = Language.GetTextValue("Mods.Antiaris.SubmarineGen");
            if (progress != null)
            {
                progress.Message = SubmarineGen;
                progress.Set(0.89f);
            }
            AntiarisHelper.Log("Generating submarine...");
            var startX = Main.maxTilesX - 200;
            var endX = Main.maxTilesX - 50;
            var subX = 0;
            var subY = 0;
            for (var attempts = 0; attempts < 10000; attempts++)
            {
                subX = WorldGen.genRand.Next(startX, endX);
                subY = 200;
                do
                {
                    subY++;
                }
                while (!Main.tile[subX, subY].active() && subY < Main.worldSurface);
                if (Main.tile[subX, subY].active() && Main.tile[subX, subY].type == TileID.Sand && AntiarisHelper.GetLiquidLevel(subX, subY - 1, LiquidType.Water) > 0)
                {
                    goto Success;
                }
            }
            AntiarisHelper.Log("Continue...");
            return false;

            Success:
            bool copper = WorldGen.CopperTierOre == 7;
			bool iron = WorldGen.IronTierOre == 6;
            for (var x = 0; x < SubmarineTiles.GetLength(1); x++)
            {
                for (var y = 0; y < SubmarineTiles.GetLength(0); y++)
                {
                    var tile = Framing.GetTileSafely(subX - 12 + x, subY - 12 + y);
                    tile.liquid = 255;
                    tile.liquidType(0);
                    switch (SubmarineTiles[y, x])
                    {
                        case 0:
                            tile.active(false);
                            break;
                        case 1:
                            tile.type = copper ? TileID.CopperPlating : TileID.TinPlating;
                            tile.active(true);
                            break;
                        case 2:
                            tile.type = TileID.Sand;
                            tile.active(true);
                            break;
                        case 3:
                            WorldGen.PlaceTile(x, y, TileID.Platforms, true, true, -1, 21);
                            break;
                        case 4:
                            tile.type = TileID.TopazGemsparkOff;
                            tile.active(true);
                            break;
                        case 5:
                        case 6:
                        case 7:
                            tile.ClearTile();
                            WorldGen.PlaceObject(x, y, TileID.LogicSensor, true, SubmarineTiles[y, x] - 2);
                            break;
                    }
                    if (SubmarineSlopes[y, x] == 5)
                    {
                        tile.halfBrick(true);
                    }
                    else
                    {
                        tile.halfBrick(false);
                        tile.slope(SubmarineSlopes[y, x]);
                    }
                    switch (SubmarineWalls[y, x])
                    {
                        case 0:
                            tile.wall = 0;
                            break;
                        case 1:
                            tile.wall = copper ? WallID.CopperPlating : WallID.TinPlating;
                            break;
                        case 2:
                            tile.wall = WallID.StoneSlab;
                            break;
                        case 3:
                            tile.wall = (ushort)(WorldGen.genRand.NextBool(2, 3) ? WallID.Glass : 0);
                            break;
                    }
                }
            }
            for (var x = 0; x < SubmarineTiles.GetLength(1); x++)
            {
                for (var y = 0; y < SubmarineTiles.GetLength(0); y++)
                {
                    switch (SubmarineObjects[y, x])
                    {
                        case 1:
                            WorldGen.PlaceObject(subX - 12 + x, subY - 12 + y, (ushort)ModLoader.GetMod("Antiaris").TileType("Compressor"), true);
                            break;
                        case 2:
                            var i = WorldGen.PlaceChest(subX - 12 + x, subY - 12 + y, (ushort)ModLoader.GetMod("Antiaris").TileType("SunkenChest"));
                            if (i != -1)
                            {
                                do_SunkenSubmarineLoot(Main.chest[i]);
                            }
                            break;
                        case 3:
                            WorldGen.PlaceObject(subX - 12 + x, subY - 12 + y, TileID.ClosedDoor, true, iron ? 15 : 14);
                            break;
                        case 4:
                            WorldGen.PlaceObject(subX - 12 + x, subY - 12 + y, TileID.TrapdoorClosed);
                            break;
                    }
                }
            }
            if (progress == null)
            {
                for (var x = subX - 12; x <= subX + 12; x++)
                {
                    for (var y = subY - 12; y <= subY; y++)
                    {
                        WorldGen.SquareTileFrame(x, y);
                        WorldGen.SquareWallFrame(x, y);
                    }
                }
            }
            return true;
        }

        bool do_MakeTheTower(GenerationProgress progress)
		{
		    string TowerGen = Language.GetTextValue("Mods.Antiaris.TowerGen");
            if (progress != null)
            {
                progress.Message = TowerGen;
                progress.Set(0.96f);
            }
			AntiarisHelper.Log("Generating the tower...");
			//thanks graydee
            List<Point> list = new List<Point>();
            for (int i = Main.maxTilesX / 5; i < Main.maxTilesX / 5 * 4; i++)
            {
                int y = 200;
                while (!WorldGen.SolidOrSlopedTile(i, y + 1))
                    y++;
                bool flag = true;
                for (int j = 0; j < 10; j++)
                    if (!WorldGen.SolidOrSlopedTile(i + j, y + 1) || Main.tile[i + j, y + 1].type != (ushort)(!WorldGen.crimson ? 23 : 199))
                        flag = false;
                if (flag)
                    for (int k = 1; k < 10; k++)
                        if (WorldGen.SolidOrSlopedTile(i - 1, y - k) || WorldGen.SolidOrSlopedTile(i + 8, y - k))
                            flag = false;
                if (flag)
                    list.Add(new Point(i, y));
            }
            if (list.Count > 0)
            {
                Point point = list[WorldGen.genRand.Next(0, list.Count<Point>())];
                TowerPositionX = point.X;
                TowerPositionY = point.Y;
            }
            goto Success;
            AntiarisHelper.Log("Continue...");
            return false;

			Success:
			var SpawnMirror = NPC.NewNPC((TowerPositionX + 5) * 16, (TowerPositionY - 19) * 16, ModLoader.GetMod("Antiaris").NPCType("Mirror"), 0, 0f, 0f, 0f, 0f, 255);
			Main.npc[SpawnMirror].homeTileX = -1;
			Main.npc[SpawnMirror].homeTileY = -1;
			Main.npc[SpawnMirror].direction = 1;
			Main.npc[SpawnMirror].homeless = false;
			TowerPositionY += 2;
			for (var x = 0; x < TowerTiles.GetLength(1); x++)
            {
                for (var y = 0; y < TowerTiles.GetLength(0); y++)
                {
                    var tile = Framing.GetTileSafely(TowerPositionX + x, TowerPositionY - y);
                    switch (TowerTiles[y, x])
                    {
                        case 0:
                            if (tile.type == TileID.Trees) WorldGen.KillTile(TowerPositionX + x, TowerPositionY - y, false, false, true);
                            break;
                        case 1:
                            tile.type = TileID.Dirt;
                            tile.active(true);
                            break;
                        case 2:
                            tile.type = 38;
                            tile.active(true);
                            break;
						case 3:
						    tile.type = (ushort)(!WorldGen.crimson ? 140 : 347);
                            tile.active(true);
							break;
						case 4:
                            WorldGen.PlaceTile(TowerPositionX + x, TowerPositionY - y, TileID.Platforms, true, true, -1, (ushort)(!WorldGen.crimson ? 1 : 5));
							break;
                    }
					if (TowerSlopes[y, x] == 5)
                    {
                        tile.halfBrick(true);
                    }
                    else
                    {
                        tile.halfBrick(false);
                        tile.slope(TowerSlopes[y, x]);
                    }
				    switch (TowerWalls[y, x])
                    {
                        case 0:
                            tile.wall = 0;
                            break;
                        case 1:
                            tile.wall = 5;
                            break;
                        case 2:
                            tile.wall = (ushort)(!WorldGen.crimson ? 33 : 174);
                            break;
                    }
					WorldGen.PlaceObject(TowerPositionX + 2, TowerPositionY - 3, 10, true, (ushort)(!WorldGen.crimson ? 1 : 10));
					WorldGen.PlaceObject(TowerPositionX + 12, TowerPositionY - 3, 10, true, (ushort)(!WorldGen.crimson ? 1 : 10));
					WorldGen.PlaceObject(TowerPositionX + 7, TowerPositionY - 3, 101, true, (ushort)(!WorldGen.crimson ? 7 : 19));
					WorldGen.PlaceObject(TowerPositionX + 6, TowerPositionY - 10, 79, true, (ushort)(!WorldGen.crimson ? 1 : 4), -1, 1);
					WorldGen.PlaceChest(TowerPositionX + 9, TowerPositionY - 18, 21, false, (ushort)(!WorldGen.crimson ? 7 : 14));
                }
            }
			if (progress == null)
            {
                for (var x = TowerPositionX; x <= TowerPositionX + 15; x++)
                {
                    for (var y = TowerPositionY - 28; y <= TowerPositionY; y++)
                    {
                        WorldGen.SquareTileFrame(x, y);
                        WorldGen.SquareWallFrame(x, y);
                    }
                }
            }
			return true;
		}

        bool do_MakeChestFinder(GenerationProgress progress)
        {
            goto Success;
            AntiarisHelper.Log("Continue...");
            return false;

            Success:
            int chestIndex;
            int inventoryIndex;
            int[] itemsToPlaceInIceChests = new int[] { ModLoader.GetMod("Antiaris").ItemType("ChestFinder") };
            int itemsToPlaceInIceChestsChoice = 0;
			int[] itemsToPlaceInIceChests2 = new int[] { ModLoader.GetMod("Antiaris").ItemType("UndyingArmyRifle") };
            int itemsToPlaceInIceChestsChoice2 = 0;
            for (chestIndex = 0; chestIndex < 1000; chestIndex++)
            {
                var chest = Main.chest[chestIndex];
                if (chest != null && Main.tile[chest.x, chest.y].frameX == 0 * 36 && Main.rand.Next(25) <= 1)
                {
                    for (inventoryIndex = 0; inventoryIndex < 40; inventoryIndex++)
                    {
                        itemsToPlaceInIceChestsChoice = Main.rand.Next(itemsToPlaceInIceChests.Length);
                        chest.item[0].SetDefaults(itemsToPlaceInIceChests[itemsToPlaceInIceChestsChoice]);
                        break;
                    }
                }
				if (chest != null && Main.tile[chest.x, chest.y].frameX == 2 * 36 && Main.rand.Next(20) <= 1)
                {
                    for (inventoryIndex = 0; inventoryIndex < 40; inventoryIndex++)
                    {
                        itemsToPlaceInIceChestsChoice2 = Main.rand.Next(itemsToPlaceInIceChests2.Length);
                        chest.item[0].SetDefaults(itemsToPlaceInIceChests2[itemsToPlaceInIceChestsChoice2]);
                        break;
                    }
                }
            }
            //thanks graydee
            //GenerateCrystal:
            var X = 1;
            var Y = 1;
            var widthScale = (Main.maxTilesX / 4200f);
            var numberToGenerate = 35;
            for (var k = 0; k < (int)(numberToGenerate * widthScale); k++)
            {
                var placement = false;
                var placed = false;
                while (!placed)
                {
                    var success = false;
                    var attempts = 0;
                    while (!success)
                    {
                        attempts++;
                        if (attempts > 1000)
                        {
                            success = true;
                            continue;
                        }
                        var i = WorldGen.genRand.Next(100, Main.maxTilesX - 100);
                        var j = WorldGen.genRand.Next((int)((double)Main.maxTilesY * 0.349999994039536), Main.maxTilesY - 50);
                        if (i <= Main.maxTilesX / 2 - 50 || i >= Main.maxTilesX / 2 + 50)
                        {
                            if (Main.tile[i, j].type == 57)
                            {
                                placement = AntiarisHelper.Placement(i, j);
                                if (placement)
                                {
                                    X = i;
                                    Y = j;
                                    for (var I = 0; I < 250; I++)
                                    {
                                        var why = Main.rand.Next(-15, 15);
                                        var ex = Main.rand.Next(-40, 40);
                                        WorldGen.PlaceObject(i + ex, j + why, ModLoader.GetMod("Antiaris").TileType("BlazingHeart"));
                                    }
                                    success = true;
                                    placed = true;
                                    continue;
                                }
                            }
                        }
                    }
                }
            }
            return true;
        }

        void do_SnowHouseLoot(Item[] ChestInventory)
        {
            var item = 0;
            var mod = ModLoader.GetMod("Antiaris");
            switch (Main.rand.Next(0, 3))
            {
                case 0:
                    item = mod.ItemType("SteelBow");
                    break;
                case 1:
                    item = mod.ItemType("SteelKnife");
                    break;
                default:
                    item = mod.ItemType("LeatherGlove");
                    break;
            }
            ChestInventory[0].SetDefaults(item);
            ChestInventory[1].SetDefaults(mod.ItemType("RobberSack"));
            ChestInventory[1].stack = Main.rand.Next(3, 6);
            ChestInventory[2].SetDefaults(ItemID.Torch);
            ChestInventory[2].stack = Main.rand.Next(10, 20);
            ChestInventory[3].SetDefaults(ItemID.ThrowingKnife);
            ChestInventory[3].stack = Main.rand.Next(25, 50);
            ChestInventory[4].SetDefaults(ItemID.HealingPotion);
            ChestInventory[4].stack = Main.rand.Next(2, 5);
            ChestInventory[5].SetDefaults(ItemID.GoldCoin);
            ChestInventory[5].stack = Main.rand.Next(3, 5);
        }

        void do_GuideHouseLoot(Item[] ChestInventory)
        {
			ChestInventory[0].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("MagicalHammer"));
            ChestInventory[1].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("LeafRoll"));
            ChestInventory[2].SetDefaults(ItemID.Rope);
            ChestInventory[2].stack = Main.rand.Next(40, 80);
            ChestInventory[3].SetDefaults(ItemID.Grenade);
            ChestInventory[3].stack = Main.rand.Next(8, 12);
            ChestInventory[4].SetDefaults(ItemID.Book);
            ChestInventory[4].stack = Main.rand.Next(3, 6);
            ChestInventory[5].SetDefaults(ItemID.IronBar);
            ChestInventory[5].stack = Main.rand.Next(3, 6);
            ChestInventory[6].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("PruningShears"));
        }

        void do_GuideHouseLoot2(Item[] ChestInventory)
		{
			ChestInventory[0].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("Note")); 
		}

        void do_PirateBoatLoot(Item[] ChestInventory)
        {
            ChestInventory[0].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("TreasureAmulet")); 
            ChestInventory[1].SetDefaults(ItemID.GoldCoin);
            ChestInventory[1].stack = Main.rand.Next(10, 14);
            ChestInventory[2].SetDefaults(ItemID.HealingPotion);
            ChestInventory[2].stack = Main.rand.Next(9, 15);
        }

        void do_PyramidLoot(Item[] ChestInventory)
        {
            ChestInventory[0].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("SandstormBoots"));
            ChestInventory[1].SetDefaults(ItemID.GoldCoin);
            ChestInventory[1].stack = Main.rand.Next(8, 12);
            ChestInventory[2].SetDefaults(ItemID.HealingPotion);
            ChestInventory[2].stack = Main.rand.Next(10, 12);
            ChestInventory[3].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("EnchantedShard"));
            ChestInventory[3].stack = Main.rand.Next(7, 11);
        }

        void do_SunkenSubmarineLoot(Chest chest)
        {
            chest.item[0].SetDefaults((ushort)ModLoader.GetMod("Antiaris").ItemType("ScubaGear"));
            var i = 1;
            if (WorldGen.genRand.NextBool(1, 3))
            {
                chest.item[i].SetDefaults(ItemID.Bomb);
                chest.item[i].stack = WorldGen.genRand.Next(10, 20);
                i++;
            }
            if (WorldGen.genRand.NextBool(1, 5))
            {
                chest.item[i].SetDefaults(ItemID.AngelStatue);
                i++;
            }
            if (WorldGen.genRand.NextBool(1, 3))
            {
                chest.item[i].SetDefaults(ItemID.Rope);
                chest.item[i].stack = WorldGen.genRand.Next(50, 100);
                i++;
            }
            if (WorldGen.genRand.NextBool(1, 2))
            {
                chest.item[i].SetDefaults(WorldGen.genRand.NextBool() ? WorldGen.ironBar : WorldGen.silverBar);
                chest.item[i].stack = WorldGen.genRand.Next(5, 15);
                i++;
            }
            if (WorldGen.genRand.NextBool(1, 2))
            {
                chest.item[i].SetDefaults(WorldGen.genRand.NextBool() ? ItemID.WoodenArrow : ItemID.Shuriken);
                chest.item[i].stack = WorldGen.genRand.Next(50, 100);
                i++;
            }
            if (WorldGen.genRand.NextBool(1, 2))
            {
                chest.item[i].SetDefaults(ItemID.LesserHealingPotion);
                chest.item[i].stack = WorldGen.genRand.Next(3, 6);
                i++;
            }
            if (WorldGen.genRand.NextBool(2, 3))
            {
                int type = 0;
                switch (Main.rand.Next(8))
                {
                    case 0:
                        type = ItemID.RegenerationPotion;
                        break;
                    case 1:
                        type = ItemID.ShinePotion;
                        break;
                    case 2:
                        type = ItemID.NightOwlPotion;
                        break;
                    case 3:
                        type = ItemID.SwiftnessPotion;
                        break;
                    case 4:
                        type = ItemID.ArcheryPotion;
                        break;
                    case 5:
                    case 6:
                        type = ItemID.GillsPotion;
                        break;
                    case 7:
                        type = ItemID.HunterPotion;
                        break;
                }
                chest.item[i].SetDefaults(type);
                chest.item[i].stack = WorldGen.genRand.Next(1, 5);
                i++;
            }
            if (WorldGen.genRand.NextBool(1, 2))
            {
                chest.item[i].SetDefaults(ItemID.Glowstick);
                chest.item[i].stack = WorldGen.genRand.Next(10, 20);
                i++;
            }
            if (WorldGen.genRand.NextBool(2, 3))
            {
                chest.item[i].SetDefaults(ItemID.RecallPotion);
                i++;
            }
            if (WorldGen.genRand.NextBool(1, 4))
            {
                chest.item[i].SetDefaults(ItemID.SilverCoin);
                chest.item[i].stack = WorldGen.genRand.Next(50, 90);
                i++;
            }
            else if (WorldGen.genRand.NextBool(1, 4))
            {
                chest.item[i].SetDefaults(ItemID.GoldCoin);
                i++;
            }
        }
    }
}

